BootStrap: docker
From: pytorch/pytorch:2.6.0-cuda12.6-cudnn9-devel

%post
    echo "Using GPU image"
    apt-get update && \
    apt-get install -y --no-install-recommends \
        nano curl ffmpeg python3-venv libsm6 libxext6 chromium-browser libnss3 \
        libgconf-2-4 libxi6 libxrandr2 libxcomposite1 libxdamage1 \
        libxext6 libxfixes3 libxrender1 libasound2 libatk1.0-0 \
        libgtk-3-0 libreoffice libjpeg-dev git vim tmux sudo

%post
    python3 -m ensurepip --upgrade
    pip install uv

%files
    . /app

%environment
    export PATH="/app/.venv/bin:$PATH"
    export DASK_DISTRIBUTED__WORKER__DAEMON=False
    export PATH="$PATH:/opt/nvim-linux-x86_64/bin/"

%post
    cd /app
    uv sync --extra all

%post
    curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.2/install.sh | bash
    \. "$HOME/.nvm/nvm.sh"
    nvm install 22

%post 
    curl -LO https://github.com/neovim/neovim/releases/latest/download/nvim-linux-x86_64.tar.gz
    rm -rf /opt/nvim
    tar -C /opt -xzf nvim-linux-x86_64.tar.gz

%runscript
    exec /bin/bash

